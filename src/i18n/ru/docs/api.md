# üìö API

## Bundler

–í–º–µ—Å—Ç–æ CLI –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å API –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —É–ø–∞–∫–æ–≤—â–∏–∫–∞ –¥–ª—è –±–æ–ª–µ–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–±–æ—Ä–∫–∏).
–°–º. –ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ, –≥–¥–µ –æ–±—ä—è—Å–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥–∞—è –æ–ø—Ü–∏—è:
```Javascript
const Bundler = require('parcel-bundler');
const Path = require('path');

// –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞
const file = Path.join(__dirname, './index.html');

// –û–ø—Ü–∏–∏ —É–ø–∞–∫–æ–≤—â–∏–∫–∞ (Bundler)
const options = {
  outDir: './dist', // –ö–∞—Ç–∞–ª–æ–≥ –¥–ª—è —Ñ–∞–π–ª–æ–≤ —Å–±–æ—Ä–∫–∏, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - dist
  outFile: 'index.html', // –ò–º—è –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
  publicUrl: './', // –ü—É—Ç—å, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - dist
  watch: true, // —Å–ª–µ–¥—É–µ—Ç –ª–∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –∏ –ø–µ—Ä–µ—Å–æ–±–∏—Ä–∞—Ç—å –∏—Ö –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - process.env.NODE_ENV !== 'production'
  cache: true, // –í–∫–ª—é—á–∞–µ—Ç –∏–ª–∏ –æ—Ç–∫–ª—é—á–∞–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - true
  cacheDir: '.cache', // –ö–∞—Ç–∞–ª–æ–≥ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é .cache
  minify: false, // –ú–∏–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã, –≤–∫–ª—é—á–µ–Ω–æ –µ—Å–ª–∏ process.env.NODE_ENV === 'production'
  target: 'browser', // browser/node/electron, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - browser
  https: false, // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞—â–∏—â—ë–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ (https) –¥–ª—è —Ñ–∞–π–ª–æ–≤, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - false
  logLevel: 3, // 3 = –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë, 2 = –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏, 1 = –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏
  hmrPort: 0, // –ü–æ—Ä—Ç –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ–∫–µ—Ç hmr, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - —Å–ª—É—á–∞–π–Ω—ã–π —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç (0 –≤ node.js –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å–ª—É—á–∞–π–Ω—ã–π —Å–≤–æ–±–æ–¥–Ω—ã–π –ø–æ—Ä—Ç)
  sourceMaps: true, // –í–∫–ª—é—á–∏—Ç—å –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å sourcemaps, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω–æ (–ø–æ–∫–∞ –µ—â—ë –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–±–æ—Ä–∫–∞—Ö)
  hmrHostname: '', // –ò–º—è —Ö–æ—Å—Ç–∞ –¥–ª—è –º–æ–¥—É–ª—è –≥–æ—Ä—è—á–µ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - ''
  detailedReport: false // –†–∞—Å–ø–µ—á–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á—ë—Ç –æ –±–∞–Ω–¥–ª–∞—Ö, —Ä–µ—Å—É—Ä—Å–∞—Ö, —Ä–∞–∑–º–µ—Ä–∞—Ö —Ñ–∞–π–ª–æ–≤ –∏ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - false, –æ—Ç—á—ë—Ç—ã —Ä–∞—Å–ø–µ—á–∞—Ç—ã–≤–∞—é—Ç—Å—è, –µ—Å–ª–∏ watch –æ—Ç–∫–ª—é—á–µ–Ω
};

async runBundle() {
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑—É–µ—Ç —É–ø–∞–∫–æ–≤—â–∏–∫, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –æ–ø—Ü–∏–∏
  const bundler = new Bundler(file, options);

  // –ó–∞–ø—É—Å–∫–∞–µ—Ç —É–ø–∞–∫–æ–≤—â–∏–∫ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≥–ª–∞–≤–Ω—É—é —Å–±–æ—Ä–∫—É
  // –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–±—ã—Ç–∏—è, –µ—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ä–µ–∂–∏–º watch, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ—Ç –ø—Ä–æ–º–∏—Å –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –∞ –Ω–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏
  const bundle = await bundler.bundle();
}

runBundle();
```

### –°–æ–±—ã—Ç–∏—è

–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ–±—ã—Ç–∏–π —É–ø–∞–∫–æ–≤—â–∏–∫–∞

* `bundled` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ Parcel —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª —Å–±–æ—Ä–∫—É, –æ—Å–Ω–æ–≤–Ω–æ–π [–±–∞–Ω–¥–ª](#bundle) –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ –∫–æ–ª–ª–±—ç–∫
```Javascript
const bundler = new Bundler(...);
bundler.on('bundled', (bundle) => {
  // —É–ø–∞–∫–æ–≤—â–∏–∫ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ä–µ—Å—É—Ä—Å—ã –∏ –±–∞–Ω–¥–ª—ã, –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
});
```

* `buildEnd` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–π —Å–±–æ—Ä–∫–∏, –æ–Ω —Ç–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏
```Javascript
const bundler = new Bundler(...);
bundler.on('buildEnd', () => {
  // –°–¥–µ–ª–∞—Ç—å —á—Ç–æ-—Ç–æ
});
```

### Bundle

`Bundle` - —ç—Ç–æ —Ç–æ, —á—Ç–æ Parcel –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–Ω–¥–ª–∞ –∏–∑ —Ä–µ—Å—É—Ä—Å–æ–≤, –æ–Ω —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–æ—á–µ—Ä–Ω–∏–µ –∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–∞–Ω–¥–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –±–∞–Ω–¥–ª–æ–≤.

#### Properties

* `type`: –¢–∏–ø —Ä–µ—Å—É—Ä—Å–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω —Å–æ–¥–µ—Ä–∂–∏—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, js, css, map, ...)
* `name`: –ò–º—è –±–∞–Ω–¥–ª–∞ (—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å –ø–æ–º–æ—â—å—é `Asset.generateBundleName()` `entryAsset`)
* `parentBundle`: –†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –±–∞–Ω–¥–ª, null –≤ —Å–ª—É—á–∞–µ –≤—Ö–æ–¥–Ω–æ–≥–æ –±–∞–Ω–¥–ª–∞
* `entryAsset`: –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–∞–Ω–¥–ª–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∏–º–µ–Ω–∏ —Å–±–æ—Ä–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤.
* `assets`: –ù–∞–±–æ—Ä (`Set`) –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ –±–∞–Ω–¥–ª–∞
* `childBundles`: –ù–∞–±–æ—Ä (`Set`) –≤—Å–µ—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö –±–∞–Ω–¥–ª–æ–≤
* `siblingBundles`: –ù–∞–±–æ—Ä (`Set`) –≤—Å–µ—Ö —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã—Ö –±–∞–Ω–¥–ª–æ–≤
* `siblingBundlesMap`: –ö–∞—Ä—Ç–∞ (`Map<String(Type: js, css, map, ...), Bundle>`) –≤—Å–µ—Ö –¥–æ—á–µ—Ä–Ω–∏—Ö –±–∞–Ω–¥–ª–æ–≤
* `offsets`: –ö–∞—Ä—Ç–∞ (`Map<Asset, number(line number inside the bundle)>`) –≤—Å–µ—Ö –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–π —Ä–µ—Å—É—Ä—Å–æ–≤ –≤–Ω—É—Ç—Ä–∏ –±–∞–Ω–¥–ª–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ç–æ—á–Ω—ã—Ö source maps

#### Tree

–ë–∞–Ω–¥–ª (`Bundle`) —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –±–∞–Ω–¥–ª (`parentBundle`), –¥–æ—á–µ—Ä–Ω–∏–π –±–∞–Ω–¥–ª  (`childBundles`) –∏ —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–π –±–∞–Ω–¥–ª (`siblingBundles`), –≤—Å–µ —ç—Ç–∏ —Å–≤–æ–π—Å—Ç–≤–∞ –≤–º–µ—Å—Ç–µ —Å–æ–∑–¥–∞—é—Ç –±—ã—Å—Ç—Ä–æ–µ –¥–µ—Ä–µ—Ä–≤–æ –±–∞–Ω–¥–ª–æ–≤ –¥–ª—è –∏—Ç–µ—Ä–∞—Ü–∏–∏.


–û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä –¥–µ—Ä–µ–≤–∞ —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –µ–≥–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–æ –±–∞–Ω–¥–ª–æ–≤

##### –î–µ—Ä–µ–≤–æ —Ä–µ—Å—É—Ä—Å–æ–≤:

`index.html` —Ç—Ä–µ–±—É–µ—Ç `index.js` –∏ `index.css`.

`index.js` —Ç—Ä–µ–±—É–µ—Ç `test.js` –∏ `test.txt`

```Text
index.html
-- index.js
 |--- test.js
 |--- test.txt
-- index.css
```

##### Bundle Tree:

`index.html` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –≤—Ö–æ–¥–Ω–æ–π —Ä–µ—Å—É—Ä—Å –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–∞–Ω–¥–ª–∞, —ç—Ç–æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –±–∞–Ω–¥–ª —Å–æ–∑–¥–∞—ë—Ç –¥–≤–∞ –¥–æ—á–µ—Ä–Ω–∏—Ö –±–∞–Ω–¥–ª–∞: –æ–¥–∏–Ω –¥–ª—è `index.js` –∏ –≤—Ç–æ—Ä–æ–π –¥–ª—è `index.css`, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–±–∞ –æ–Ω–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –æ—Ç —Ç–∏–ø–∞ `html`.

`index.js` —Ç—Ä–µ–±—É–µ—Ç –¥–≤–∞ —Ñ–∞–π–ª–∞, `test.js` –∏ `test.txt`.

`test.js` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ —Ä–µ—Å—É—Ä—Å–∞–º –±–∞–Ω–¥–ª–∞ `index.js`, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω –∏–º–µ–µ—Ç —Ç–æ—Ç –∂–µ —Ç–∏–ø, —á—Ç–æ –∏ `index.js`

`test.txt` —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –±–∞–Ω–¥–ª –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ –¥–æ—á–µ—Ä–Ω–∏–π –±–∞–Ω–¥–ª `index.js`, –ø–æ—Å–∫–æ–ª—å–∫—É —ç—Ç–æ –¥—Ä—É–≥–æ–π  —Ç–∏–ø —Ä–µ—Å—É—Ä—Å–∞, —á–µ–º `index.js`

`index.css` –Ω–∏—á–µ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏, —Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –≤—Ö–æ–¥–Ω—ã–π —Ä–µ—Å—É—Ä—Å.

`index.css` –∏ `index.js` - —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –±–∞–Ω–¥–ª—ã –¥–ª—è –¥—Ä—É–≥ –¥—Ä—É–≥–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –∏–º–µ—é—Ç –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —Ä–æ–¥–∏—Ç–µ–ª—è.

```Text
index.html
-- index.js (–≤–∫–ª—é—á–∞–µ—Ç index.js –∏ test.js)
 |--- test.txt (–≤–∫–ª—é—á–∞–µ—Ç test.txt)
-- index.css (–≤–∫–ª—é—á–∞–µ—Ç index.css)
```

### –ú–∏–¥–ª–≤–∞—Ä

–ú–∏–¥–ª–≤–∞—Ä (middleware) –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ HTTP-—Å–µ—Ä–≤–µ—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `express` –∏–ª–∏ node `http`).

–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–∏–¥–ª–≤–∞—Ä Parcel —Å express
```Javascript
const Bundler = require('parcel-bundler');
const app = require('express')();

const file = 'index.html'; // –ü–µ—Ä–µ–¥–∞–π—Ç–µ –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –∫ —Ç–æ—á–∫–µ –≤—Ö–æ–¥–∞ –∑–¥–µ—Å—å
const options = {}; // –°–º. —Ä–∞–∑–¥–µ–ª –æ–ø—Ü–∏–π API, –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —É–ø–∞–∫–æ–≤—â–∏–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–∞–π–ª–∞ –∏ –æ–ø—Ü–∏–π
const bundler = new Bundler(file, options);

// –ü—É—Ç—å express –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–∏–¥–ª–≤–∞—Ä —É–ø–∞–∫–æ–≤—â–∏–∫–∞, —ç—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç Parcel –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É —Å–µ—Ä–≤–µ—Ä—É express
app.use(bundler.middleware());

// –°–µ—Ä–≤–µ—Ä –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–µ—Ç –ø–æ—Ä—Ç 8080
app.listen(8080);
```
