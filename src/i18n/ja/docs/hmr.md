# ğŸ”¥ Hot Module Replacement

Hot Module Replacementï¼ˆHMRï¼‰ã¯ã€ãƒšãƒ¼ã‚¸å…¨ä½“ã‚’æ›´æ–°ã—ãªãã¦ã‚‚ã€å®Ÿè¡Œæ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶å†…ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è‡ªå‹•çš„ã«æ›´æ–°ã™ã‚‹ã“ã¨ã§é–‹ç™ºè€…ä½“é¨“ã‚’å‘ä¸Šã•ã›ã‚‹ä»•çµ„ã¿ã§ã™ã€‚ã“ã‚Œã¯ã€å¤‰æ›´ã‚’è¡Œã£ã¦ã‚‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã®çŠ¶æ…‹ï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆï¼‰ã¯ä¿æŒã•ã‚Œã‚‹ã“ã¨ã‚’æ„å‘³ã—ã¾ã™ã€‚Parcel ã® HMR å®Ÿè£…ã¯ã€ãã®ã¾ã¾ã§ JavaScript ã¨ CSS ã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ‰ã§ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã¨ã€HMR ã¯è‡ªå‹•çš„ã«ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ã¨ã€Parcel ã¯å·®åˆ†ã‚’ãƒªãƒ“ãƒ«ãƒ‰ã—ã€æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚“ã§ã„ã‚‹å®Ÿè¡Œä¸­ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æ›´æ–°ã‚’çŸ¥ã‚‰ã›ã¾ã™ã€‚ãã®å¾Œã€æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã¯å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç½®ãæ›ãˆã€ã™ã¹ã¦ã®è¦ªè¦ç´ ã¨å…±ã«å†è©•ä¾¡ã•ã‚Œã¾ã™ã€‚ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒç ´æ£„ã•ã‚Œã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã¨ãã€ã¾ãŸã¯æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ›´æ–°ã•ã‚Œã‚‹ã¨ãã€ã‚³ãƒ¼ãƒ‰ã«é€šçŸ¥ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ã‚‹ `module.hot` API ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ãƒ•ãƒƒã‚¯ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚[react-hot-loader](https://github.com/gaearon/react-hot-loader) ã®ã‚ˆã†ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚’æ‰‹åŠ©ã‘ã™ã‚‹ã“ã¨ãŒã§ãã€Parcel ãªã‚‰è¨­å®šä¸è¦ã§ä½¿ç”¨ã§ãã¾ã™ã€‚

çŸ¥ã£ã¦ãŠãã¨è‰¯ã„æ–¹æ³•ãŒ 2 ã¤ã‚ã‚Šã¾ã™ï¼š `module.hot.accept` ã¨ `module.hot.dispose` ã§ã™ã€‚`module.hot.accept` ã¯ã€ã‚ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¾ãŸã¯ãã®ä¾å­˜é–¢ä¿‚ã®ã„ãšã‚Œã‹ãŒæ›´æ–°ã•ã‚ŒãŸã¨ãã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚`module.hot.dispose` ã¯ã€ã‚ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒç½®ãæ›ãˆã‚‰ã‚Œã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã¨ãã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

```javascript
if (module.hot) {
  module.hot.dispose(function() {
    // module is about to be replaced
  })

  module.hot.accept(function() {
    // module or one of its dependencies was just updated
  })
}
```

## ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Parcel ã¯å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒ `node_module` ãƒ•ã‚©ãƒ«ãƒ€ãƒ¼ã«å­˜åœ¨ã—ãªã„çŠ¶æ³ã«å‡ºãã‚ã—ãŸå ´åˆã¯ã„ã¤ã§ã‚‚ã€ãã‚Œã‚‰ã‚’è‡ªå‹•ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ã¨ã™ã‚‹ä»•çµ„ã¿ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€yarn.lock ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‹ã‹ã©ã†ã‹ã«ã‚ˆã£ã¦ã€`yarn` ã‹ `npm` ã‚’ç”¨ã„ã¦è¡Œã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã£ã¦ã€é–‹ç™ºè€…ã¯ä¸€åº¦ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ä¸Šã§ Parcel ã‹ã‚‰ exit ã—ãŸã‚Šã€è¤‡æ•°ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ç«‹ã¡ä¸Šã’ã‚‹å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚

ã“ã‚Œã‚‰ã¯ é–‹ç™ºç’°å¢ƒ ([`serve`](cli.md#serve) ã‚‚ã—ãã¯ [`watch`](cli.md#watch) ã‚³ãƒãƒ³ãƒ‰) æ™‚ã«é©ç”¨ã•ã‚Œã¾ã™ã€‚ã—ã‹ã—ãªãŒã‚‰ã€ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç’°å¢ƒï¼ˆ[`build`](cli.md#build) ã‚³ãƒãƒ³ãƒ‰ï¼‰æ™‚ã«ã¯ã€ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã®äºˆæœŸã—ãªã„å‰¯ä½œç”¨ã‚’å›é¿ã™ã‚‹ãŸã‚ã«ç„¡åŠ¹åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚

ã‚ãªãŸã¯ [`--no-autoinstall`](cli.md#disable-autoinstall) ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†ã“ã¨ã§ã“ã®æ©Ÿèƒ½ã‚’ç„¡åŠ¹åŒ–ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## ã‚»ãƒ¼ãƒ•ãƒ©ã‚¤ãƒˆ

IDE ã‚„ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã®ä¸­ã«ã¯ã€`ã‚»ãƒ¼ãƒ•ãƒ©ã‚¤ãƒˆï¼ˆsafe writeï¼‰`ã¨å‘¼ã°ã‚Œã‚‹ã€ãƒ‡ãƒ¼ã‚¿ã®æå¤±ã‚’é˜²ããŸã‚ã«ã‚³ãƒ”ãƒ¼ã‚’å–ã‚Šä¿å­˜æ™‚ã«åå‰ã‚’å¤‰æ›´ã™ã‚‹ã¨ã„ã†æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚

ãƒ›ãƒƒãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒªãƒ—ãƒ¬ã‚¤ã‚¹ãƒ¡ãƒ³ãƒˆï¼ˆHMRï¼‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã€ã“ã®æ©Ÿèƒ½ã¯ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ã®è‡ªå‹•æ¤œå‡ºã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¦ã—ã¾ã†ã®ã§ ã‚»ãƒ¼ãƒ•ãƒ©ã‚¤ãƒˆã‚’ç„¡åŠ¹ã«ã™ã‚‹ãŸã‚ã«ã¯ã€ä¸‹è¨˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

- `Sublime Text 3` `atomic_save: "false"` ã‚’ preferences ã«è¿½åŠ ã™ã‚‹ã€‚
- `IntelliJ` preferences å†…ã§ "safe write" ã‚’æ¤œç´¢ã—ã€ç„¡åŠ¹åŒ–ã™ã‚‹ã€‚
- `Vim` `:set backupcopy=yes` ã‚’è¨­å®šã«è¿½åŠ ã™ã‚‹ã€‚
- `WebStorm` Preferences > Appearance & Behavior > System Settings å†…ã® `Use "safe write"` ã®ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã™ã€‚
