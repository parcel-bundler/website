# ğŸ”¥ ãƒ›ãƒƒãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒªãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ¡ãƒ³ãƒˆ

ãƒ›ãƒƒãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒªãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ¡ãƒ³ãƒˆï¼ˆHMRï¼‰ã¯ã€ãƒšãƒ¼ã‚¸å…¨ä½“ã‚’ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ã™ã‚‹ã“ã¨ãªãã€å®Ÿè¡Œæ™‚ã«ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’è‡ªå‹•çš„ã«æ›´æ–°ã™ã‚‹ã“ã¨ã§é–‹ç™ºä½“é¨“ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚ã¤ã¾ã‚Šã€å°ã•ãªã‚‚ã®ã‚’å¤‰æ›´ã—ã¦ã‚‚ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã¯ä¿æŒã•ã‚Œã¾ã™ã€‚
Parcelã®HMRå®Ÿè£…ã¯ã€JavaScriptã¨CSSã‚¢ã‚»ãƒƒãƒˆã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚ HMRã¯ã€æœ¬ç•ªãƒ¢ãƒ¼ãƒ‰ã§ãƒãƒ³ãƒ‰ãƒ«ã™ã‚‹ã¨è‡ªå‹•çš„ã«ç„¡åŠ¹ã«ãªã‚Šã¾ã™ã€‚

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ã¨ã€Parcelã¯å¤‰æ›´ã•ã‚ŒãŸå†…å®¹ã‚’å†æ§‹ç¯‰ã—ã€å®Ÿè¡Œä¸­ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã‚’å«ã‚€æ›´æ–°ã‚’é€ä¿¡ã—ã¾ã™ã€‚æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ã¯å¤ã„ã‚³ãƒ¼ãƒ‰ã‚’ç½®ãæ›ãˆã€å…¨ã¦ã®è¦ªã¨ä¸€ç·’ã«å†è©•ä¾¡ã•ã‚Œã¾ã™ã€‚ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã¯ã€`module.hot`APIã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ã“ã®APIã¯ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒç ´æ£„ã•ã‚Œã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã¨ãã€ã¾ãŸã¯æ–°ã—ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒå…¥ã£ãŸã¨ãã«ã‚ãªãŸã®ã‚³ãƒ¼ãƒ‰ã«é€šçŸ¥ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚[react-hot-loader](https://github.com/gaearon/react-hot-loader)ã¯ã€ã“ã®ãƒ—ãƒ­ã‚»ã‚¹ã«å½¹ç«‹ã¡ã€Parcelã§ã™ãã«ä½¿ã†ã“ã¨ãŒã§ãã¾ã™ã€‚

çŸ¥ã£ã¦ãŠãã¹ããƒ¡ã‚½ãƒƒãƒ‰ãŒ2ã¤ã‚ã‚Šã¾ã™ã€‚ `module.hot.accept` ã¨ `module.hot.dispose`ã§ã™ã€‚ ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã¨ã‚‚ã«`module.hot.accept`ã‚’å‘¼ã¶ã¨ã€ãã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚„ãã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾å­˜é–¢ä¿‚ãŒæ›´æ–°ã•ã‚ŒãŸã¨ãã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå‘¼ã°ã‚Œã¾ã™ã€‚`module.hot.dispose`ã¯ãã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒç½®ãæ›ãˆã‚‰ã‚Œã‚ˆã†ã¨ã—ã¦ã„ã‚‹ã¨ãã«å‘¼ã°ã‚Œã¾ã™ã€‚

```javascript
if (module.hot) {
  module.hot.dispose(function () {
    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒç½®ãæ›ãˆã‚‰ã‚Œã‚‹ã¨ãã«å‘¼ã°ã‚Œã¾ã™
  });

  module.hot.accept(function () {
    // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¾ãŸã¯ãã®ä¾å­˜é–¢ä¿‚ãŒæ›´æ–°ã•ã‚Œã‚‹ã¨ãã«å‘¼ã°ã‚Œã¾ã™
  });
}
```

## å®‰å…¨ãªæ›¸ãè¾¼ã¿ï¼ˆSafe writeï¼‰
ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã‚„IDEã®ä¸­ã«ã¯ã€`safe write`ã¨å‘¼ã°ã‚Œã‚‹æ©Ÿèƒ½ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ”ãƒ¼ã‚’å–ã£ã¦ä¿å­˜ã—ãŸã¨ãã«åå‰ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ã§ã€ãƒ‡ãƒ¼ã‚¿ã®æå¤±ã‚’é˜²ãã“ã¨ãŒã§ãã¾ã™ã€‚

ãƒ›ãƒƒãƒˆãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒªãƒ­ãƒ¼ãƒ‰ï¼ˆHMRï¼‰ã‚’ä½¿ç”¨ã™ã‚‹å ´åˆã€ã“ã®æ©Ÿèƒ½ã¯ãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°ã®è‡ªå‹•æ¤œå‡ºã‚’ãƒ–ãƒ­ãƒƒã‚¯ã—ã¾ã™ã€‚ `safe write`ã‚’ç„¡åŠ¹ã«ã™ã‚‹ãŸã‚ã«ä»¥ä¸‹ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

* `Sublime Text 3` ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®šã« atomic_save: "false" ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
* `IntelliJ` è¨­å®šã§ "safe write" ã¨æ¤œç´¢ã—ã¦ã€å‡ºã¦ããŸé …ç›®ã‚’ç„¡åŠ¹åŒ–ã—ã¦ãã ã•ã„ã€‚
* `Vim` è¨­å®šã« :set backupcopy=yes ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
* `WebStorm` Preferences > Appearance & Behavior > System Settings ä¸­ã®"safe write"ã®ãƒã‚§ãƒƒã‚¯ã‚’å¤–ã—ã¦ãã ã•ã„ã€‚
